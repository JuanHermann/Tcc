<?xml version="1.0" encoding="UTF-8"?>


<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	template="#{layoutMB.template}">

	<ui:define name="head-end">
		<ui:param name="renderBreadCrumb" value="false" />
	</ui:define>

	<ui:define name="title">
		<h2 class="align-center">Agenda</h2>

	</ui:define>

	<ui:define name="body">

		<h:form id="formAgenda">
			<p:growl id="messages" showDetail="true" />

			<p:schedule id="schedule" value="#{indexBean.eventModel}"
				locale="pt_BR" widgetVar="myschedule" timeZone="UTC-3"
				timeFormat="dd/MM/yyyy" minTime="7:00" maxTime="20:00">

				<p:ajax event="dateSelect" listener="#{indexBean.onDateSelect}"
					update="eventDetails" oncomplete="PF('inserir').show();" />
				<p:ajax event="eventSelect" listener="#{indexBean.onEventSelect}"
					update="eventDetails" oncomplete="PF('inserir').show();" />
				<p:ajax event="eventMove" listener="#{indexBean.onEventMove}"
					update="messages" />
				<p:ajax event="eventResize" listener="#{indexBean.onEventResize}"
					update="messages" />

			</p:schedule>



			<p:dialog widgetVar="inserir" header="Cadastrar Horario"
				showEffect="clip" hideEffect="clip">

				<h:panelGrid id="eventDetails" columns="2">
					<h:form id="formulario">
						<p:outputLabel for="tipo" value="Tipo:" />
						<p:selectOneRadio id="tipo" value="#{indexBean.tipo}"
							unselectable="true">
							<f:selectItem itemLabel="Serviço" itemValue="servico"
								id="radioServico" />
							<f:selectItem itemLabel="Bloqueio" itemValue="bloqueio"
								id="radioBloqueio" />
							<p:ajax event="change" process="@this" update="idGeral" />
						</p:selectOneRadio>
						<p:outputPanel id="idGeral">
							<p:outputPanel rendered="#{indexBean.mostrarForm()}">
								<h:panelGrid id="eventDetails" columns="1">
									<p:outputLabel for="servico" value="Serviço:" />

									<p:selectCheckboxMenu id="servico"
										value="#{indexBean.servicosSelecionados}" label="Serviços"
										multiple="true" filter="true" filterMatchMode="startsWith"
										panelStyle="width:250px">
										<f:selectItems value="#{indexBean.servicos}" var="servico"
											itemLabel="#{servico.nome}" />
										<p:ajax event="toggleSelect" update="funcionario"
											oncomplete="#{indexBean.buscarFuncionarios()}" />
									</p:selectCheckboxMenu>


									<p:outputLabel for="funcionario" value="Funcionario:" />

									<p:selectOneMenu id="funcionario"
										converter="#{usuarioConverter}">
										<f:selectItem itemLabel="Nenhuma Preferencia" itemValue="" />
										<f:selectItems value="#{indexBean.setFuncionarios}"
											var="funcionario" itemLabel="#{funcionario.nome}"
											itemValue="#{usuario}" />
									</p:selectOneMenu>

									<p:outputLabel for="data" value="Dia:" />

									<p:calendar id="data" value="#{indexBean.data}"
										timeZone="UTC-3" pattern="dd/MM/yyyy">
										<p:ajax event="dateSelect"
											listener="#{indexBean.buscarHorarios}" update="horario" />
									</p:calendar>

									<p:outputLabel value="Horario:" for="horario" />

									<p:selectOneMenu id="horario" converter="#{timeConverter}">
										<f:selectItem itemLabel="Selecione o horario" itemValue="" />
										<f:selectItems value="#{indexBean.horarios}" var="horario"
											itemLabel="#{horario}" itemValue="#{Time}" />
									</p:selectOneMenu>
								</h:panelGrid>

							</p:outputPanel>
							<p:outputPanel rendered="#{!indexBean.mostrarForm()}">
								<h:panelGrid columns="1">
									<p:outputLabel for="inicio" value="Inicio" />
									<p:calendar id="inicio" value="#{indexBean.event.startDate}"
										timeZone="UTC-3" pattern="dd/MM/yyyy HH:mm" />


									<p:outputLabel for="final" value="Final" />
									<p:calendar id="final" value="#{indexBean.event.startDate}"
										timeZone="UTC-3" pattern="dd/MM/yyyy HH:mm" />


								</h:panelGrid>
							</p:outputPanel>

							<p:commandButton value="Salvar"
								action="#{indexBean.salvarAgendamento()}"
								oncomplete="PF('myschedule').update();PF('inserir').hide();" />

						</p:outputPanel>
					</h:form>

				</h:panelGrid>

			</p:dialog>
		</h:form>

	</ui:define>


</ui:composition>

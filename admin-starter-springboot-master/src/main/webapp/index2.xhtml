<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" template="#{layoutMB.template}">

	<ui:define name="title">
        Cadastro de Serviços
    </ui:define>



	<ui:define name="head-end">
		<ui:param name="renderBreadCrumb" value="false" />
	</ui:define>

	<ui:define name="body">
		<f:metadata>
			<f:viewParam name="id" value="#{servicoForm.id}" />
			<f:viewAction action="#{servicoForm.init}" />
		</f:metadata>


		<h:form id="form" data-toggle="validator" prependId="false"
			role="form">


			<div class="box box-primary">
				<div class="box-header with-border">
					<div id="main-buttons" class="hidden-sm hidden-xs">


						<p:commandButton value="Salvar"
							action="#{indexBean.salvarAgendamento()}" update="@form"
							icon="fa fa-check" styleClass="btn-primary" />
						<p:spacer width="5" />
						<p:commandButton value="Limpar" action="#{servicoForm.novo()}"
							rendered="#{servicoForm.objeto.id == null}" process="@this"
							icon="fa fa-refresh" styleClass="btn-success" update="@form"
							resetValues="true" />

						<p:commandButton value="Deletar" action="#{servicoForm.remover()}"
							rendered="#{servicoForm.objeto.id != null}" process="@this"
							icon="fa fa-trash" styleClass="btn-danger" update="@form"
							resetValues="true">
							<f:setPropertyActionListener value="true"
								target="#{facesContext.externalContext.flash.keepMessages}" />
							<p:confirm header="Confirmação"
								message="Tem certeza que deseja deletar?" icon="ui-icon-danger" />
						</p:commandButton>
						<p:spacer width="5" />
						<p:commandButton value="Voltar" immediate="true"
							action="servico-list?faces-redirect=true" process="@this"
							icon="fa fa-reply" />
					</div>

					<p:splitButton value="Salvar" action="#{servicoForm.salvar()}"
						update="@form" icon="fa fa-check"
						styleClass="hidden-md hidden-lg btn-primary">
						<p:menuitem value="Limpar" action="#{servicoForm.novo()}"
							rendered="#{servicoForm.objeto.id == null}" process="@this"
							update="@form" resetValues="true" icon="fa fa-refresh" />
						<p:menuitem value="Deletar" action="#{servicoForm.remover()}"
							rendered="#{servicoForm.objeto.id != null}" process="@this"
							icon="fa fa-trash" update="@form" resetValues="true">
							<p:confirm header="Confirmação"
								message="Tem certeza que deseja deletar?" icon="ui-icon-danger" />
						</p:menuitem>
						<p:menuitem value="Voltar" immediate="true"
							action="servico-list?faces-redirect=true" process="@this"
							icon="fa fa-reply" />
					</p:splitButton>

					<p:separator />

					<div class="ui-g ui-fluid">
					
					<h:panelGrid id="eventDetails" columns="1">
					<p:outputLabel for="tipo" value="Tipo:" />
					<p:selectOneRadio id="tipo" value="#{indexBean.tipo}"
						unselectable="true">
						<f:selectItem itemLabel="Serviço" itemValue="servico"
							id="radioServico" />
						<f:selectItem itemLabel="Bloqueio" itemValue="bloqueio"
							id="radioBloqueio" />
						<p:ajax event="change" process="@this" update="idGeral" />
					</p:selectOneRadio>
					<p:outputPanel id="idGeral">
						<p:outputPanel rendered="#{indexBean.mostrarForm()}">
							<h:panelGrid columns="1">
								<p:outputLabel for="cliente" value="Cliente:" />

								<p:selectOneMenu id="cliente" value="#{indexBean.cliente}"
									filter="true" converter="#{usuarioConverter}">
									<f:selectItem itemLabel="Selecione o cliente"
										itemValue="#{null}" />
									<f:selectItems value="#{indexBean.clientes}" var="usuario"
										itemLabel="#{usuario.nome}" itemValue="#{usuario}" />
								</p:selectOneMenu>


								<p:outputLabel for="servico" value="Serviço:" />

								<p:selectCheckboxMenu id="servico"
									value="#{indexBean.servicosSelecionados}" label="Serviços"
									multiple="true" filter="true" filterMatchMode="startsWith"
									panelStyle="width:250px">
									<f:selectItems value="#{indexBean.servicos}" var="servico"
										itemLabel="#{servico.nome}" />
									<p:ajax event="change" update="funcionario horario"
										listener="#{indexBean.buscarFuncionarios()}" />
								</p:selectCheckboxMenu>


								<p:outputPanel rendered="#{indexBean.mostrarFuncionario()}">
									<p:outputLabel for="funcionario" value="Funcionario:" />

									<p:selectOneMenu id="funcionario"
										value="#{indexBean.funcionario}"
										converter="#{usuarioConverter}">
										<f:selectItem itemLabel="Nenhuma Preferencia"
											itemValue="#{null}" />
										<f:selectItems value="#{indexBean.setFuncionarios}"
											var="funcionario" itemLabel="#{funcionario.nome}"
											itemValue="#{usuario}" />
									</p:selectOneMenu>
								</p:outputPanel>

								<p:outputLabel for="data" value="Dia:" />

								<p:calendar id="data" value="#{indexBean.data}" timeZone="UTC-3"
									pattern="dd/MM/yyyy">
									<p:ajax event="dateSelect"
										listener="#{indexBean.buscarHorarios}" update="horario" />
								</p:calendar>

								<p:outputLabel value="Horario:" for="horario" />

								<p:selectOneMenu id="horario" converter="#{timeConverter}"
									value="#{indexBean.objeto.horaInicio}">
									<f:selectItem itemLabel="Selecione o horario" itemValue="" />
									<f:selectItems value="#{indexBean.horarios}" var="horario"
										itemLabel="#{horario}" itemValue="#{Time}" />
								</p:selectOneMenu>
							</h:panelGrid>

						</p:outputPanel>
						<p:outputPanel rendered="#{!indexBean.mostrarForm()}">
							<h:panelGrid columns="1">
								<p:outputLabel for="inicio" value="Inicio" />
								<p:calendar id="inicio" value="#{indexBean.event.startDate}"
									timeZone="UTC-3" pattern="dd/MM/yyyy HH:mm" />


								<p:outputLabel for="final" value="Final" />
								<p:calendar id="final" value="#{indexBean.dataFinal}"
									timeZone="UTC-3" pattern="dd/MM/yyyy HH:mm" />


							</h:panelGrid>
						</p:outputPanel>

						<p:commandButton value="Salvar"
							action="#{indexBean.salvarAgendamento()}" update="@form"
							icon="fa fa-check" styleClass="btn-primary" />

					</p:outputPanel>

				</h:panelGrid></div>
				</div>
			</div>

			<p:confirmDialog global="true" showEffect="fade" hideEffect="fade"
				styleClass="box-danger box-solid">
				<p:commandButton value="Sim" type="button"
					styleClass="btn-material btn-primary ui-confirmdialog-yes"
					icon="fa fa-check" />
				<p:commandButton value="Não" type="button"
					styleClass="btn-material btn-danger ui-confirmdialog-no"
					icon="fa fa-close" />
			</p:confirmDialog>
		</h:form>


	</ui:define>

</ui:composition>

<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" template="#{layoutMB.template}">



	<ui:define name="title">
        Meus Agendamentos
    </ui:define>
	<ui:define name="description">
        Aqui você pode ver seus agendamentos e agendar novos horarios.
    </ui:define>

	<ui:define name="head-end">
		<ui:param name="renderBreadCrumb" value="false" />
	</ui:define>

	<ui:define name="body">
		<f:metadata>
			<f:viewParam name="id" value="#{usuarioLogadoBean.usuario.id}" />
			<f:viewAction action="#{indexClienteBean.init}" />
		</f:metadata>


		<h:form id="form" prependId="false">


			<div class="box box-primary">
				<div class="box-header with-border">


					<div class="ui-g ui-fluid">
						<div class="ui-sm-12 ui-md-4 ui-lg-6">
							<p:commandButton id="agendar" value="Agendar Novo Horario"
								onclick="PF('inserir').show();" type="button"
								icon="fa fa-plus-square-o" styleClass="btn-info" />

						</div>

					</div>
					<div class="ui-g ui-fluid">
						<div class="ui-sm-12 ui-md-4 ui-lg-1"></div>
						<div class="ui-sm-12 ui-md-4 ui-lg-4">
							<p:separator />
						</div>

					</div>

					<div class="ui-g ui-fluid">
						<div class="ui-sm-12 ui-md-4 ui-lg-6">
							<p:panelMenu model="#{indexClienteBean.menuModel}" />

						</div>

					</div>




					<p:growl id="growl" sticky="true" showDetail="true" life="3000" />

					<p:dialog widgetVar="inserir" header="Cadastrar Horario"
						showEffect="clip" hideEffect="clip">

						<h:panelGrid id="eventDetails" columns="1">
							<p:outputPanel id="idGeral">
								<h:panelGrid columns="1">



									<p:outputLabel for="servico" value="Serviço:" />

									<p:selectCheckboxMenu id="servico"
										value="#{indexBean.servicosSelecionados}" label="Serviços"
										multiple="true" filter="true" filterMatchMode="startsWith"
										panelStyle="width:250px">
										<f:selectItems value="#{indexBean.servicos}" var="servico"
											itemLabel="#{servico.nome}" itemValue="#{servico}" />
										<p:ajax event="change" update="funcionario horario"
											listener="#{indexBean.buscarFuncionarios()}" />
									</p:selectCheckboxMenu>


									<p:outputPanel rendered="#{indexBean.mostrarFuncionario()}">
										<p:outputLabel for="funcionario" value="Funcionario:" />

										<p:selectOneMenu id="funcionario"
											value="#{indexBean.funcionario}"
											converter="#{usuarioConverter}">
											<f:selectItem itemLabel="Nenhuma Preferencia"
												itemValue="#{null}" />
											<f:selectItems value="#{indexBean.setFuncionarios}"
												var="funcionario" itemLabel="#{funcionario.nome}"
												itemValue="#{usuario}" />
										</p:selectOneMenu>
									</p:outputPanel>

									<p:outputLabel for="data" value="Dia:" />

									<p:calendar id="data" value="#{indexBean.objeto.data}"
										pattern="dd/MM/yyyy" converter="#{localDateConverter}">
										<p:ajax event="dateSelect"
											listener="#{indexBean.buscarHorarios}" update="horario" />
									</p:calendar>

									<p:outputLabel value="Horario:" for="horario" />

									<p:selectOneMenu id="horario" converter="#{localTimeConverter}"
										value="#{indexBean.objeto.horaInicio}">
										<f:selectItem itemLabel="#{indexBean.stringHorario}"
											itemValue="" />
										<f:selectItems value="#{indexBean.horarios}" var="horario"
											itemLabel="#{horario}" itemValue="#{localTime}" />
									</p:selectOneMenu>
								</h:panelGrid>
								<p:commandButton value="Salvar"
									action="#{indexClienteBean.salvarAgendamento()}"
									update="@form" icon="fa fa-check"
									oncomplete="PF('inserir').hide();" />

							</p:outputPanel>

						</h:panelGrid>

					</p:dialog>



				</div>

			</div>

		</h:form>

	</ui:define>

</ui:composition>
